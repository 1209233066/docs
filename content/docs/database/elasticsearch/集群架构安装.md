---
date: '2025-06-12T15:22:40+08:00'
draft: false
title: '集群版本安装'
linkTitle: '集群版本安装'
type: blog
toc_hide: false
hide_summary: true
weight: 2
description: >
  部署集群版本elasticsearch
tags: ["elasticsearch"]
categories: ["ELK"]
url: elasticsearch/install2.html
author: "wangendao"
---

{{% alert title="" color="" %}}
文档适用于操作系统centos7.x  和 elasticsearch `7.9.3 ` 、`8.8.1`



+ elasticsearch 依赖jdk 环境，如果无法判断使用哪个版本jdk。可以[下载](https://www.elastic.co/cn/downloads/past-releases#elasticsearch)/[国内下载镜像](https://repo.huaweicloud.com)带有jdk版本的elasticsearch。

+ 启动后监听本机的9200端口为客户端提供数据访问，监听9300端口用于集群内部集群选举和数据同步。

+ elasticsearch 属于io密集型应用，尽可能把数据目录单独挂载出来。并使用高性能磁盘。

{{% /alert %}}

### 集群部署

| 节点名称 | ip           | elasticsearch集群名 |
| -------- | ------------ | ------------------- |
| `node-1` | `10.4.7.250` | `my-application`    |
| `node-2` | `10.4.7.251` | `my-application`    |
| `node-3` | `10.4.7.252` | `my-application`    |



> 集群模式只是配置文件不同，其他配置参考**单机部署**

{{< tabpane text=true right=false >}}
  {{% tab header="**集群**:" disabled=true /%}}
  {{% tab header="**节点一**" lang="en" %}}

```bash
tee /data/elasticsearch/elasticsearch-${version}/config/elasticsearch.yml <<EOF
# 所有节点集群名称必须相同
cluster.name: my-application
# 节点名称集群内不许唯一
node.name: node-1
path.data: /data/elasticsearch/elasticsearch-data

path.logs: /data/elasticsearch/elasticsearch-log
# 是否在程序启动时立即分配指定大小内存给elasticsearch进程
bootstrap.memory_lock: false 
network.host: 10.4.7.250
http.port: 9200
#初始化时哪些节点可以被选举为master ，集群内的主机可以都填写上，也可以填写部分主机。支持使用 `node.name` 或者 `ip地址`
cluster.initial_master_nodes: ["node-1","node-2","node-3"]
# 启动时向哪些主机进行宣告，进行集群选举，集群内的主机都要填写上。包括自己
discovery.seed_hosts: ["10.4.7.250","10.4.7.251","10.4.7.252"]
# 当集群进行数据恢复时必须大于指定数量的节点在线，才可以进行数据恢复。通常设置为 (集群节点数量/2+1)
gateway.recover_after_nodes: 1
# 当删除索引时是否支持索引名称的模糊匹配，当`true` 时表示不支持模糊。
action.destructive_requires_name: true
EOF
```



  {{% /tab %}}
  {{% tab header="**节点二**" lang="en" %}}

```bash
tee /data/elasticsearch/elasticsearch-${version}/config/elasticsearch.yml <<EOF
# 所有节点集群名称必须相同
cluster.name: my-application
# 节点名称集群内不许唯一
node.name: node-2
path.data: /data/elasticsearch/elasticsearch-data

path.logs: /data/elasticsearch/elasticsearch-log
# 是否在程序启动时立即分配指定大小内存给elasticsearch进程
bootstrap.memory_lock: false 
network.host: 10.4.7.251
http.port: 9200
#初始化时哪些节点可以被选举为master ，集群内的主机可以都填写上，也可以填写部分主机。支持使用 `node.name` 或者 `ip地址`
cluster.initial_master_nodes: ["node-1","node-2","node-3"]
# 启动时向哪些主机进行宣告，进行集群选举，集群内的主机都要填写上。包括自己
discovery.seed_hosts: ["10.4.7.250","10.4.7.251","10.4.7.252"]
# 当集群进行数据恢复时必须大于指定数量的节点在线，才可以进行数据恢复。通常设置为 (集群节点数量/2+1)
gateway.recover_after_nodes: 1
# 当删除索引时是否支持索引名称的模糊匹配，当`true` 时表示不支持模糊。
action.destructive_requires_name: true
EOF
```



  {{% /tab %}}

  {{% tab header="**节点三**" lang="en" %}}



```bash
tee /data/elasticsearch/elasticsearch-${version}/config/elasticsearch.yml <<EOF
# 所有节点集群名称必须相同
cluster.name: my-application
# 节点名称集群内不许唯一
node.name: node-3
path.data: /data/elasticsearch/elasticsearch-data

path.logs: /data/elasticsearch/elasticsearch-log
# 是否在程序启动时立即分配指定大小内存给elasticsearch进程
bootstrap.memory_lock: false 
network.host: 10.4.7.252
http.port: 9200
#初始化时哪些节点可以被选举为master ，集群内的主机可以都填写上，也可以填写部分主机。支持使用 `node.name` 或者 `ip地址`
cluster.initial_master_nodes: ["node-1","node-2","node-3"]
# 启动时向哪些主机进行宣告，进行集群选举，集群内的主机都要填写上。包括自己
discovery.seed_hosts: ["10.4.7.250","10.4.7.251","10.4.7.252"]
# 当集群进行数据恢复时必须大于指定数量的节点在线，才可以进行数据恢复。通常设置为 (集群节点数量/2+1)
gateway.recover_after_nodes: 1
# 当删除索引时是否支持索引名称的模糊匹配，当`true` 时表示不支持模糊。
action.destructive_requires_name: true
EOF
```

  {{% /tab %}}

{{< /tabpane >}}





如果可以查看到node信息，则集群节点创建成功

```bash
curl 127.0.0.1:9200/_cat/nodes
```

