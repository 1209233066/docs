---
date: '2025-05-17T14:23:22+08:00'
draft: false
title: '环境检查'
type: blog
toc_hide: false
hide_summary: true
weight: 1
description: >
  prerun| tidb
tags: ["tidb","prerun"]
categories: ["tidb"]
url: tidb/prerun.html
author: "wangendao"
summary: >
  tidb prerun
---



### 版本选择

企业版和社区版的区别

### 安装前环境检查
**操作系统**
  支持部署在x86_64、arm_64、容器环境的 Linux 操作系统。

  {{% alert title="Warning" color="warning" %}}
  + TiDB 在 v8.4.0 DMR 和 v8.5.0 版本中移除了对 glibc 2.17 的适配，以及对 CentOS Linux 7 的兼容性测试和支持，建议使用 Rocky Linux 9.1 及以上的版本。

    如果在使用 CentOS Linux 7 的情况下将 TiDB 升级到 v8.4.0 DMR 或 v8.5.0 版本，将存在导致集群不可用的风险。
  + 为了更好地服务仍在使用 CentOS Linux 7 的用户，TiDB 从 v8.5.1 版本起重新适配 glibc 2.17，恢复了对 CentOS Linux 7 的兼容性支持和测试。
    {{% /alert %}}

{{< tabpane text=true right=false >}}
  {{% tab header="**软件要求**:" disabled=true /%}}
  {{% tab header="中控机" lang="en" %}}
| 软件    | 版本         |
| :------ | :----------- |
| sshpass | 1.06 及以上  |
| TiUP    | 1.5.0 及以上 |
  {{% /tab %}}
  {{% tab header="目标主机" lang="de" %}}
| 软件    | 版本          |
| :------ | :------------ |
| sshpass | 1.06 及以上   |
| numa    | 2.0.12 及以上 |
| tar     | 任意          |
  {{% /tab %}}
{{< /tabpane >}}


{{% alert title="Info" color="info" %}}
+ 生产环境中的 TiDB 和 PD 可以部署和运行在同一台服务器上，如对性能和可靠性有更高的要求，应尽可能分开部署。
+ 强烈建议分别为生产环境中的 TiDB、TiKV 和 TiFlash 配置至少 8 核的 CPU。强烈推荐使用更高的配置，以获得更好的性能。
+ TiKV 硬盘大小配置建议 PCIe SSD 不超过 4 TB，普通 SSD 不超过 1.5 TB。
{{% /alert %}}


{{< tabpane text=true right=false >}}
  {{% tab header="**硬件要求**:" disabled=true /%}}
  {{% tab header="开发及测试环境" lang="en" %}}
| **组件** | **CPU** | **内存** | **本地存储**                                                 | **网络** | **实例数量(最低要求)** |
| :------- | :------ | :------- | :----------------------------------------------------------- | :------- | :--------------------- |
| TiDB     | 8 核+   | 16 GB+   | [磁盘空间要求](https://docs.pingcap.com/zh/tidb/stable/hardware-and-software-requirements/#磁盘空间要求) | 千兆网卡 | 1（可与 PD 同机器）    |
| PD       | 4 核+   | 8 GB+    | SAS, 200 GB+                                                 | 千兆网卡 | 1（可与 TiDB 同机器）  |
| TiKV     | 8 核+   | 32 GB+   | SSD, 200 GB+                                                 | 千兆网卡 | 3                      |
| TiFlash  | 32 核+  | 64 GB+   | SSD, 200 GB+                                                 | 千兆网卡 | 1                      |
| TiCDC    | 8 核+   | 16 GB+   | SAS, 200 GB+                                                 | 千兆网卡 | 1                      |

  {{% /tab %}}
  {{% tab header="生产环境" lang="de" %}}
| **组件** | **CPU** | **内存** | **硬盘类型**   | **网络**             | **实例数量(最低要求)** |
| :------- | :------ | :------- | :------------- | :------------------- | :--------------------- |
| TiDB     | 16 核+  | 48 GB+   | SSD            | 万兆网卡（2 块最佳） | 2                      |
| PD       | 8 核+   | 16 GB+   | SSD            | 万兆网卡（2 块最佳） | 3                      |
| TiKV     | 16 核+  | 64 GB+   | SSD            | 万兆网卡（2 块最佳） | 3                      |
| TiFlash  | 48 核+  | 128 GB+  | 1 or more SSDs | 万兆网卡（2 块最佳） | 2                      |
| TiCDC    | 16 核+  | 64 GB+   | SSD            | 万兆网卡（2 块最佳） | 2                      |
| 监控     | 8 核+   | 16 GB+   | SAS            | 千兆网卡             | 1 |
  {{% /tab %}}
{{< /tabpane >}}


**网络要求**
| 组件              | 默认端口 | 说明                                               |
| :---------------- | :------- | :------------------------------------------------- |
| TiDB              | 4000     | 应用及 DBA 工具访问通信端口                        |
| TiDB              | 10080    | TiDB 状态信息上报通信端口                          |
| TiKV              | 20160    | TiKV 通信端口                                      |
| TiKV              | 20180    | TiKV 状态信息上报通信端口                          |
| PD                | 2379     | 提供 TiDB 和 PD 通信端口                           |
| PD                | 2380     | PD 集群节点间通信端口                              |
| TiFlash           | 9000     | TiFlash TCP 服务端口                               |
| TiFlash           | 3930     | TiFlash RAFT 服务和 Coprocessor 服务端口           |
| TiFlash           | 20170    | TiFlash Proxy 服务端口                             |
| TiFlash           | 20292    | Prometheus 拉取 TiFlash Proxy metrics 端口         |
| TiFlash           | 8234     | Prometheus 拉取 TiFlash metrics 端口               |
| CDC               | 8300     | CDC 通信接口                                       |
| Monitoring        | 9090     | Prometheus 服务通信端口                            |
| Monitoring        | 12020    | NgMonitoring 服务通信端口                          |
| Node_exporter     | 9100     | TiDB 集群每个节点的系统信息上报通信端口            |
| Blackbox_exporter | 9115     | Blackbox_exporter 通信端口，用于 TiDB 集群端口监控 |
| Grafana           | 3000     | Web 监控服务对外服务和客户端(浏览器)访问端口       |
| Alertmanager      | 9093     | 告警 web 服务端口                                  |
| Alertmanager      | 9094     | 告警通信端口                                       |