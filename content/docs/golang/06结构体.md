---
title: "结构体"
linkTitle: "结构体"
date: 2025-05-09
toc_hide: false
hide_summary: true
weight: 6
description: >
  结构体|数据类型

tags: ["golang","结构体"]
categories: ["golang"]
url: golang/struct.html
---


golang 除了包含内置数据类型，同样还允许用户通过`type` 关键字自定义数据类型。自定义数据类型是内置数据类型一个或多个类型的组合。

示例：

+ ```go
  package main
  
  import "fmt"
  
  func main() {
  	type newstring string
  	var name newstring
  	name = "张三"
  	fmt.Printf("%s的数据类型是：%T\n", name, name) //张三的数据类型是：main.newstring
  }
  ```

+ ```go
  package main
  
  import "fmt"
  
  func main() {
  	type newstring = string
  	var name newstring
  	name = "张三"
  	fmt.Printf("%s的数据类型是：%T\n", name, name) // 张三的数据类型是：string
  }
  ```

  

### 结构体的基本语法

**结构体定义基本语法**

```go
type <name> struct {}
```

示例：

```go
package main

import (
	"fmt"
)

type Persion struct {
	Name string
	Age  int
}

func main() {
	var p Persion
	p.Name = "张三"
	p.Age = 33
	fmt.Println(p) //{张三 33}
}
```

**结构体赋值的语法**

+ 使用 “.” 赋值

  ```go
  // 使用 . 对字段赋值
  package main
  
  import "fmt"
  
  type Persion struct {
  	Name string
  	Age  int
  }
  
  func main() {
  
  	var p Persion
  	p.Name = "张三"
  	p.Age = 33
  	fmt.Println(p)
  }
  ```

+ 声明变量时赋值

  ```go
  package main
  
  import "fmt"
  
  type Persion struct {
  	Name string
  	Age  int
  }
  
  func main() {
  
  	var p = Persion{
  		Name: "张三",
  		Age:  33,
  	}
  	fmt.Println(p)
  }
  ```
  
  也可以省略字段直接赋值
  
  ```go
  package main
  
  import "fmt"
  
  type Persion struct {
  	Name string
  	Age  int
  }
  
  func main() {
  
  	var p = Persion{
  		"张三",
  		33,
  	}
  	fmt.Println(p)
  }
  ```
  
  

### 实例化结构体

+ 使用`new()`函数实例化

  ```go
  // 结构体定义后并不会分配内存空间，一旦结构体变量完成实例化，就完成了内存地址的分配
  package main
  
  import "fmt"
  
  type Persion struct {
  	Name string
  	Age  int
  }
  
  func main() {
  
  	// 通过new() 返回数据类型的指针
  	p := new(Persion)
  	fmt.Printf("实例化后p的内存地址为：%p\n保存的值为: %+v\n", p, *p)
  	// 实例化后p的内存地址为：0xc0000a8018
  	// 保存的值为: {Name: Age:0}
  }
  ```

  

+ 使用取地址符号 `&` 实例化

  ```go
  package main
  
  import "fmt"
  
  type Persion struct {
  	Name string
  	Age  int
  }
  
  func main() {
  	var p = &Persion{}
  	fmt.Printf("实例化后p的内存地址为：%p\n保存的值为: %+v\n", p, *p)
  	// 实例化后p的内存地址为：0xc000010030
  	// 保存的值为: {Name: Age:0}
  }
  ```

  

  
  
  > [waring] 
  >
  >  <span style="color: red; background-color: black;">`var p *Persion`并没有完成实例化，go程序并未分配内存给`p`,此时`p` 就是空指针</span> 
  
  ---
  
  
  
  ```go
  package main
  
  import "fmt"
  
  type Persion struct {
  	Name string
  	Age  int
  }
  
  func main() {
  
  	var p *Persion
  	fmt.Printf("实例化后p的内存地址为：%p\n保存的值为: %+v\n", p, p)
  	// 实例化后p的内存地址为：0x0
  	// 保存的值为: <nil>
  }
  ```

### 结构体方法

+ 通过构造函数返回结构体变量，进而通过结构体变量操作结构体方法

  示例：

  ```go
  package main
  
  import "fmt"
  
  type Persion struct {
  	Name string
  	Age  int
  }
  
  func initFunction(name string, age int) *Persion {
  	return &Persion{
  		Name: name,
  		Age:  age,
  	}
  }
  
  func (p *Persion) run() {
  	fmt.Println(p.Name, "可以跑步")
  }
  func main() {
  	p := initFunction("张三", 33)
  	p.run()
  }
  ```

  **方法同样支持传参，和定义返回值**

  ```go
  package main
  
  import "fmt"
  
  type Persion struct {
  	Name string
  	Age  int
  }
  
  func initFunction(name string, age int) *Persion {
  	return &Persion{
  		Name: name,
  		Age:  age,
  	}
  }
  
  // 不带参数的方法
  func (p *Persion) run() {
  	fmt.Println(p.Name, "可以跑步")
  }
  
  // 带参数的方法
  func (p *Persion) work(w string) {
  	fmt.Printf("做一份%s的工作\n", w)
  }
  
  // 带返回值的方法
  
  func (p *Persion) rename(newName string) *Persion {
  	p.Name = newName
  	return p
  }
  func main() {
  	p := initFunction("张三", 33)
  	p.run()
  	p.work("挑战")
  	newPersion := p.rename("王五")
  	fmt.Printf("%+v\n", *newPersion)
  }
  ```

  

### 匿名结构体

**结构体定义基本语法**

```go
<name>:=struct{
	field_name definition
}{
	field_name: value
}
```

举例：

```go
package main

import "fmt"

func main() {
	p := struct {
		Name string
		Age  int
	}{
		Name: "张三",
		Age:  33,
	}
	fmt.Println(p)
}
```



### 结构体嵌套



+ 匿名字段

  ```go
  package main
  
  import "fmt"
  
  func main() {
  	// 没有定义名称的字段称为匿名字段
  	type Persion struct {
  		string
  		int
  	}
  
  	var p = Persion{
  		string: "张三",
  		int:    33,
  	}
  	fmt.Println(p) //{张三 33}
  }
  ```

+ 结构体嵌套

  ```go
  package main
  
  import "fmt"
  
  type Alert struct {
  	Status string
  	Alerts []AlertItem
  }
  
  type AlertItem struct {
  	AlertName string
  }
  
  func main() {
  	var alert = &Alert{
  		Status: "firing",
  		Alerts: []AlertItem{{
  			AlertName: "cpu",
  		},
  		},
  	}
  
  	fmt.Printf("%+v\n", alert) //&{Status:firing Alerts:[{AlertName:cpu}]}
  }
  ```

  

  