---
date: '2025-05-21T16:12:16+08:00'
draft: false
title: '常用命令'
type: blog
toc_hide: false
hide_summary: true
weight: 2
description: >
  command|linux
tags: ["command"]
categories: ["linux"]
url: linux/command.html
author: "wangendao"
---

![](https://rpic.origz.com/api.php?category=photography)

{{< cardpane >}}
  {{< card header="**文本处理**" >}}
  <a href="#mkdir">mkdir</a>, <a href="#touch">touch</a>, <a href="#mktemp">mktemp</a>, <a href="#ln">ln</a>, 
  <a href="#tar">tar</a>, <a href="#gzip">gzip</a>, <a href="#zip">zip</a>, <a href="#unzip">unzip</a>, 
  <a href="#grep">grep</a>, <a href="#sed">sed</a>, <a href="#awk">awk</a>, <a href="#tr">tr</a>, <a href="#sort">sort</a>, <a href="#uniq">uniq</a>, <a href="#more">more</a>, <a href="#less">less</a>, <a href="#dd">dd</a>, <a href="#echo">echo</a>, <a href="#printf">printf</a>,
  <a href="#tail">tail</a>, <a href="#tailf">tailf</a>, <a href="#head">head</a>, <a href="#stat">stat</a>, <a href="#wc">wc</a>, <a href="#cat">cat</a>, <a href="#tac">tac</a>, <a href="#nl">nl</a>, <a href="#tee">tee</a>, <a href="#cut">cut</a>, <a href="#source">source</a>, <a href="#read">read</a>, <a href="#seq">seq</a>, 
  <a href="#find">find</a>, <a href="#xargs">xargs</a>, <a href="#exec">exec</a>, <a href="#expr">expr</a>, <a href="#install">install</a>,  <a href="#test">test</a>,   <a href="#eval">eval</a>, 
  <a href="#base64">base64</a>, <a href="#openssl">openssl</a>, <a href="#cfssl">cfssl</a>
  {{< /card >}}
  {{< card header="**系统命令**" >}}
  <a href="#top">top/htop</a>, <a href="#vmstat">vmstat</a>, <a href="#sar">sar</a>, <a href="#iostat">iostat</a>, <a href="#ionice">ionice</a>, <a href="#taskset">taskset</a>, <a href="#uptime">uptime</a>, <a href="#journalctl">journalctl</a>, <a href="#lsmem">lsmem</a>, <a href="#lscpu">lscpu</a>, <a href="#crontab">crontab</a>, <a href="#at">at</a>, <a href="#hostname">hostname</a>, <a href="#halt">halt</a>, <a href="#init">init</a>, <a href="#chkconfig">chkconfig</a>, <a href="#ntpdate">ntpdate</a>, <a href="#chronyd">chronyd</a>, <a href="#ps">ps</a>, <a href="#pstree">pstree</a>, <a href="#pgrep">pgrep</a>, <a href="#pidof">pidof</a>, <a href="#kill">kill</a>, <a href="#killall">killall</a>, <a href="#runlevel">runlevel</a>, <a href="#free">free</a>, <a href="#dmidecode">dmidecode</a>, <a href="#date">date</a>, <a href="#yum">yum</a>, <a href="#rpm">rpm</a>, <a href="#getent">getent</a>, <a href="#info">info</a>, <a href="#man">man</a>, <a href="#lz">lz</a>, <a href="#sz">sz</a>
  {{< /card >}}
  {{< card header="**网络管理**" >}}
  <a href="#curl">curl</a>, <a href="#wget">wget</a>, <a href="#dig">dig</a>, <a href="#nc">nc</a>, <a href="#tcpdump">tcpdump</a>, <a href="#nmap">nmap</a>, <a href="#telnet">telnet</a>, <a href="#ip">ip</a>, <a href="#ifconfig">ifconfig</a>, <a href="#route">route</a>, <a href="#ifup">ifup</a>, <a href="#ifdown">ifdown</a>, <a href="#brctl">brctl</a>
  {{< /card >}}
  {{< card header="**磁盘管理**" >}}
  <a href="#df">df</a>, <a href="#du">du</a>, <a href="#fdisk">fdisk</a>, <a href="#parted">parted</a>,<a href="#mount">mount</a>, <a href="#showmount">showmount</a>, <a href="#lsblk">lsblk</a>, <a href="#blkid">blkid</a>, <a href="#fsdump">fsdump</a>
  {{< /card >}}
{{< /cardpane >}}



<span id=date>**date**</span>

+ 查看时区: `date -R `
+ 获取当前时间时间戳: `date +%s`
+ 时间戳格式化为时间格式: `date -d @1674108177 +"%F %H:%m%S"`
+ 时间格式格式化为时间戳: ` date -d "2023-01-19 14:01:57" +%s`

<span id=yum>**yum**</span>

+ 列出软件包可以用的版本: `yum search --showduplicates docker`
+ 查看软件包信息: `yum info docker`

<span id=rpm>**rpm**</span>

+ 查看rpm包是否安装: `rpm -qa docker`

+ 列出软件包相关文件: `rpm -ql docker`



<span id=getent >**getent**</span>

```bash
# grep ^root /etc/passwd
getent passwd root
```



<span id=read>**read**</span>

```bash
-p    指定提示符  
-t    指定超时时间
-s    隐藏输入内容
-u    读取文件描述符
-n    读取指定字符后自动回车 例如： read -n 1 -p "将在你输入第一个字符后自动回车："
REPLY 默认接受键盘的输入的变量名

#read -t 30 -p "please input firstname:" firstname
#echo $firstname
#read -t 30 -p "please input firstname:"
#echo $REPLY
```



<span id=stat>**stat**</span>

+ 获取文件的权限信息: `stat -c %A /etc/services`
+ 获取文件的权限信息: `stat -c %a /etc/services`
+ 获取文件的大小: `stat -c %s /etc/services`



<span id=echo>**echo**</span>

```bash
echo -e 
转义

　　　　\a 发出警告声； 
　　　　\b 删除前一个字符； 
　　　　\c 最后不加上换行符号； 
　　　　\f 换行但光标仍旧停留在原来的位置； 
　　　　\n 换行且光标移至行首； 
　　　　\r 光标移至行首，但不换行； 
　　　　\t 插入tab； 
　　　　\v 与\f相同； 
　　　　\\ 插入\字符； 
　　　　\nnn 插入nnn（八进制）所代表的ASCII字符；
```



<span id=printf>**printf**</span>

优势就在于格式化处理字符串

{{< tabpane text=true right=false >}}
  {{% tab header="格式化字符" lang="en" %}}
| 格式符 | 描述                                     |
| ------ | ---------------------------------------- |
| %s     | 字符串                                   |
| %f     | 浮点格式                                 |
| %b     | 转义字符会被转义                         |
| %c     | ASCII字符，显示对应参数的第一个字符      |
| %d, %i | 十进制整数                               |
| %o     | 不带正负号的八进制值                     |
| %u     | 不带正负号的十进制值                     |
| %x     | 不带正负号的十六进制值，用a到f表示10至15 |
| %X     | 不带正负号的十六进制值，用A到F表示10至15 |
| %%     | 表示‘%’本身                              |

  {{% /tab %}}
  {{% tab header="转义字符" lang="en" %}}



| 转义字符 | 描述                                               |
| -------- | -------------------------------------------------- |
| \a       | 警告字符，常为ASCII的BEL字符                       |
| \b       | 后退                                               |
| \c       | 不显示输出结果中任何结尾的换行字符                 |
| \f       | 换页（formfeed）                                   |
| \n       | 换行                                               |
| \r       | 回车                                               |
| \t       | 水平制表符                                         |
| \v       | 垂直制表符                                         |
| \\       | “\”本身                                            |
| \ddd     | 表示1到3位数八进制值得字符串，仅在字符格式串中有效 |
| \0ddd    | 表示1到3位数八进制值得字符串                       |

  {{% /tab %}}
  {{% tab header="对齐和精度" lang="en" %}}  



| 对齐和精度控制格式符 | 描述                                                         |
| -------------------- | ------------------------------------------------------------ |
| %7s                  | 当前替换符对应的输出长度为7个字符宽，不足补齐，超出也正常显示 |
| %-7s                 | “-”，表示左对齐，不加时，是右对齐                            |
| %+5d                 | 正数会自动变为+num                                           |
| %12.3f               | “.3”表示保留小数点后三位，%f默认是小数点后6位                |
| %12.5d               | “.5”表示整数的长度，不足用0补齐                              |

  {{% /tab %}}
{{< /tabpane >}}

```bash
printf "%s\n" {1..20}
printf "%10s\n" {1..20}
printf "%-10s\n" {1..20}
printf "%2.2f\n" {1..20}
printf "%2d\n" {1..20}
printf "(%d)\n" {1..20} 
```

<span id=sort>**sort**</span>

+ 按照ASCII 排序: `sort /etc/hosts`
+ 排序并去除重复行: `sort -u /etc/hosts`
+ 按照ASCII  逆序: `sort -r /etc/hosts`
+ 按照数字排序: `sort -n /etc/hosts`
+ 按照月份排序: `sort -M /etc/hosts`
+ 按照指定分隔符分割后，指定列排序: `sort -t ":" -k 3 -n /etc/passwd`





<span id=uniq>**uniq**</span>

+ 查看文件内容等同cat: `uniq /etc/hosts`
+ 只显示重复行: `uniq -d /etc/hosts`
+ 去重重复行显示: `uniq -u /etc/hosts`
+ 显示重复行出现的次数: `uniq -c /etc/hosts`





 <span id=uniq>**wc**</span>

+ 统计文本函数: `wc -l /etc/hosts`
+ 统计文本字数: `wc -w /etc/hosts`
+ 统计文本字节数: `wc -c /etc/hosts`
+ 统计文本中最长一行包含的字节数: `wc -L /etc/hosts`





 <span id=seq>**seq**</span>

语法	<font color=red> **`命令格式seq [OPTION]... FIRST INCREMENT LAST`**</font>

+ 从2开始到10结尾步长为1：`seq 2 10`
+ 从2开始到10结尾步长为2: `seq 2 2 10`
+ 从2开始到10结尾步长为2，等宽显示: `seq -w 2 2 10`
+ 从2开始到10结尾步长为2，等宽显示.修改分隔符为空格: `seq -s " " -w 2 2 10`



<span id=cut>**cut**</span>

语法：<font color=red> `cut OPTION... [FILE]`</font>

+ 按照字符串截取: `echo "http://127.0.0.1/#/zh-cn/bash"|cut -c 1-4,8-10`
+ 按照字符串截取,1-  表示从第一个字符到结尾: `echo "http://127.0.0.1/#/zh-cn/bash"|cut -c 1-`
+ 按照字符串截取,-5  表示从第一个字符到结尾: `echo "http://127.0.0.1/#/zh-cn/bash"|cut -c -5`
+ 按照分隔符截取: `echo "http://127.0.0.1/#/zh-cn/bash"|cut -d '/' -f1,2,3`







<span id=tr>**tr**</span>

*translate or delete characters*

删除:	`echo {a..z}{1..10}|tr -d [0-9]`

替换:	`echo {a..z}{1..10}|tr [a-z] [A-Z]`



<span id=find>**find**</span>

```bash
find  
    [!]-type 
    [!]--maxdepth levels
    [!]-name 
    -o   或  
    -a   and
    -mtime +-7
    -ctime +-7 
    -atime +-7
    -perm
    -user <username>
    -group <groupname>
```

```bash
find / -type f -name curl -or -name wget -perm 755
find /etc -name "host*" -print
find /etc -name "host*" -print0
find / -nouser -a -nogroup
# 查找时排除指定文件夹./rules_file
find . -path "./rules_file" -prune -o -print
```





<span id=expr>**expr**</span>

+ 计算字符串长度: `expr length "hello world"`
+ 模式匹配

```bash
'STRING : REGEX'
     执行模式匹配。两端参数会转换为字符格式，且第二个参数被视为正则表达式(GNU基本正则)，它默认会隐含前缀"^"。随后将第一个参数和正则模式做匹配。
     如果匹配成功，且REGEX使用了'\('和'\)'，则此表达式返回匹配到的，如果未使用'\('和'\)'，则返回匹配的字符数。
     如果匹配失败，如果REGEX中使用了'\('和'\)'，则此表达式返回空字符串，否则返回为0。
     只有第一个'\(...\)'会引用返回的值；其余的'\(...\)'只在正则表达式分组时有意义。
     在正则表达式中，'\+'，'\?'和'\|'分表代表匹配一个或多个，0个或1个以及两端任选其一的意思
```

```bash
[root@allinone ~]# expr "423-46-7" : "\([0-9]\{,3\}-[0-9]\{,3\}-[0-9]\{,3\}\)"
423-46-7
```

```bash
[root@allinone ~]# expr "423-46-7" : "[0-9]\{,3\}-[0-9]\{,3\}-[0-9]\{,3\}"    
8
```



<span id=mktemp>**mktemp**</span>

创建临时的文件：`mktemp`
创建临时的命名文件: `mktemp -t test.XXXXXXXXXX`
创建一个临时目录 `mktemp -d`
创建一个临时命名目录 `mktemp -d test.XXXXXXXXXX`



<span id=install>**install**</span>

是mkdir 、copy 、chown、chmod等命令的复合体

+ 创建目录，并授予权限。所有者nginx,所属组nginx 权限7777 类型为目录: `install -o nginx -g nginx -m 7777 -d /tmp/456`
+ 拷贝文件： `install -m 755 /etc/hosts /tmp`



<span id=install>**base64**</span>

base64加密: `echo "123"|base64`
base64解码 : `echo $(echo 123|base64)|base64 -d`



<span id=test>**test**</span>

| 参数   | 代表意义                                                     |
| ------------ | ------------------------------------------------------------ |
| -e           | 该【文件名】是否存在（常用）                                 |
| -f           | 该【文件名】是否存在且为文件（file）（常用）                 |
| -d           | 该【文件名】是否存在且为目录（directory）                    |
| -b           | 该【文件名】是否存在且为 block device 设备                   |
| -c           | 该【文件名】是否存在且为 character device 设备               |
| -S           | 该【文件名】是否存在且为 socket 文件                         |
| -p           | 该【文件名】是否存在且为 FIFO (pipe) 文件                    |
| -L           | 该【文件名】是否存在且为一个链接文件                         |
| -r           | 检测该文件名是否存在且具有【可读】的权限                     |
| -w           | 检测该文件名是否存在且具有【可写】的权限                     |
| -x           | 检测该文件名是否存在且具有【可执行】的权限                   |
| -u           | 检测该文件名是否存在且具有【SUID】的属性                     |
| -g           | 检测该文件名是否存在且具有【SGID】的属性                     |
| -k           | 检测该文件名是否存在且具有【Sticky bit】的属性               |
| -s           | 检测该文件名是否存在且为【非空文件】                         |
| -nt          | 两个文件之间的比较，如：test file1 -nt file2（newer than）判断 file1 是否比 file2 新 |
| -ot          | （older than）判断 file1 是否比 file2 旧                     |
| -ef          | 判断 file1 与 file2 是否为同一文件，可用在判断 hard link 的判定上。主要意义在判断两个文件是否均指向同一个 inode |
| -eq          | 两数值相等（equal）                                          |
| -ne          | 两数值不等（not equal）                                      |
| -gt          | n1 大于 n2（greater than）                                   |
| -lt          | n1 小于 n2（less than）                                      |
| -ge          | n1 大于等于 n2（greater than or equal）                      |
| -le          | n1 小于等于 n2（less than or equal）                         |
| -z string    | 判定字符串是否为 0？若 string 为空字符串，则为 true          |
| -n string    | 判定字符串是否非空为 0？若 string 为非空字符串，则为 true    |
| str1 = str2  | 判断 str1 是否等于 str2，若相等，则返回 true                 |
| str1 != str2 | 判断 str1 是否不等于 str2，若相等，则返回 false              |
| -a           | [and] 两条件同时成立，例如 test -f file -a -x file，则 file 同时具有 -f 与 x 权限时，返回 true |



<span id=curl>**curl**</span>

> curl 是向服务端发送和接收数据的工具。
> *支持的协议(DICT, FILE, FTP, FTPS, GOPHER, HTTP, HTTPS, IMAP, IMAPS, LDAP,LDAPS, POP3, POP3S, RTMP, RTSP, SCP, SFTP, SMTP, SMTPS, TELNET and TFTP）*

****

+ 查看服务端响应头信息: `curl -I https://www.baidu.com`

+ 获取响应码: ` curl -o /dev/null -s -w "%{http_code}" https://www.baidu.com`

+ 携带证书访问: `curl -k --cacert /etc/kubernetes/pki/ca.crt  --cert /etc/kubernetes/pki/apiserver-kubelet-client.crt --key /etc/kubernetes/pki/apiserver-kubelet-client.key https://127.0.0.1:10250/metrics`

+ 指定请求头信息 `curl -k -H "Authorization: Bearer $TOKEN" https://<KUBERNETES_API_SERVER>/api/v1/nodes`

+ 指定请求方法, -g, --globoff允许url中存在 {} [] 等特殊字符 : `curl -g -X GET http://114.132.158.2:9100/metrics?collect[]=cpu`

+ 通过post发送数据: `curl -X POST -H 'content-type: application/json' -d '{"password":"123"}'  http://172.16.100.10:8060/dingtalk/webhook1/send`

+ 文件下载: `curl -fSsL https://example.com/file.zip -o /local/path/file.zip`

  ```bash
  -f, --fail  如果curl失败时不显示错误输出，主要用于书写脚本
  -s, --silent   静默
  -L, --location  如果站定已经搬迁，支持重定向
  ```

<span id=dig>**dig**</span>

+ 查询A 记录: `dig @114.114.114.114 a baidu.com +short`
+ 查询RTP记录 `dig @114.114.114.114 -x 1.2.3.4.in-addr.arpa`



<span id=mount>**mount**</span>

+ 查看所有系统挂载: `mount`
+ 挂载定义在`/etc/fstab`中的所有文件系统: `mount -a`
+ 挂载定义在`/etc/fstab`中的指定文件系统 `mount -a -t ext4`
+ 指定挂载选项: `mount -o noatime,rw /dev/sdb /mnt`



**xargs**

```bash
举例：
[root@test /]# cat 1.txt 
a b c d e f
a b c d e f
a b c d e f
a b c d e f
[root@test /]# cat 1.txt|xargs       对文本格式的重定向
a b c d e f a b c d e f a b c d e f a b c d e f
[root@test /]# cat 1.txt|xargs -n6   每行6个重排
a b c d e f
a b c d e f
a b c d e f
a b c d e f

[root@test /]# cat 1.txt|xargs|sort >2.txt      对文本格式重定向后默认排序输出到2.txt
a b c d e f a b c d e f a b c d e f a b c d e f

举例：
[root@test /]# cat 2.txt 
a b ,c d e f a b ,c d e f a b ,c d e f a b ,c d e f
[root@test /]# cat 2.txt|xargs -d"," -n2  以，为分隔符每行两个域重排
a b  c d e f a b 
c d e f a b  c d e f a b 
c d e f

find /tmp -name 1.log -type f -print0|xargs -0 rm -f   可用于处理文件中含有空格换行的文件
find ./ -name "*.log" -type f -print0|xargs -0 rm -f    用于日志的删除
find -type f -name "*.jpg" -print|xargs tar zcvf jpg.tar.gz  压缩所有图片文件
cat url-list.txt|xargs wget -c  
```

<span id=kill>**kill**</span>

```bash
kill -l 查询所有信号量
kill -s HUP 3940
kill -0 3940
kill -15
```

<span id=crontab>**crontab**</span>

**crond**是执行定时任务的后台程序，`systemctl status crond`命令确保服务正常运行。

`/etc/crontab` 系统定时任务，默认为空

` /etc/cron.d/` 包含系统定时任务

`/var/spool/cron` 包含用户创建的定时任务，文件名以用户名命名

`/var/log/cron` 包含定时任务执行的日志

**示例：**

```bash
SHELL=/bin/bash
PATH=/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=""

*/5 * * * * echo 1 >/dev/null 2>&1
10/5 * * * * echo 1 >/dev/null 2>&1
*/5 23,24 * * * echo 1 >/dev/null 2>&1
*/5 20-24 * * * echo 1 >/dev/null 2>&1
```





<span id=at>**at**</span>

<span id=tar>**tar**</span>

```bash
 -v, --verbose 显示过程
 -f  --file    
 -c  --creat
 -z, --gzip   gzip压缩方式
 -j, --bzip2  bizp压缩方式
 -x  --extract  取出
 -C, --directory DIR 指定解压路径
 -t, --list 显示压缩文件列表
 --exclude=     压缩但不包含否个文件
 -X, --exclude-from FILE 用文件列表的方式排除不需要打包的文件
 -Z, --compress, --uncompress 调用compress完成压缩
 -N, --after-date DATE, --newer DATE 打包比指定日期新的文件，用于增量打包
 -p, --same-permissions, --preserve-permissions   保持属性
              extract all protection information

 -P, --absolute-names                             保存根目录的 /
              don't strip leading '/'s from file names  
```



+ 打包时排除指定文件

  ```bash
  tar --exclude 'conf/input.promtail'  --exclude 'conf/input.redis*' -czvf  seagullagent.tar.gz  conf seagullagent
  ```

  





<span id=fsdumpe2fs>**dumpe2fs**</span>

> dump ext2/ext3/ext4 的文件系统信息,xfs 文件格式待整理

```bash
# 磁盘
[root@tencent-sh ~]# dumpe2fs /dev/vda1 |grep -i "inode size"
dumpe2fs 1.42.9 (28-Dec-2013)
Inode size:               256
[root@tencent-sh ~]# dumpe2fs /dev/vda1 |grep -i "block size"
dumpe2fs 1.42.9 (28-Dec-2013)
Block size:               4096
```



<span id=ln>**ln**</span>

语法：`ln [OPTION]src dest`

example

```bash
ln -svf /etc/hosts /tmp/hosts
```

<span id=nl>**nl**</span>

语法：`nl [OPTION] file` 

example

```bash
# 显示行号
nl /etc/hosts
```



<span id=ntpdate>**ntpdate**</span>
在centos6 中我们经常使用的时间同步命令

```bash
timedatectl set-timezone Asia/Shanghai            
date -s "12/12/2010 15:40:30“
hwclock -w 

*/5 * * * * /usr/sbin/ntpdate 10.0.76.177 >/dev/null 2>&1
```

<span id=chronyd>**chronyd**</span>

<span id=cfssl>**cfssl**</span>

下载地址

```bash
# cfssl  生成证书
wget https://pkg.cfssl.org/R1.2/cfssl_linux-amd64 -O /usr/bin/cfssl
# cfssl-json  证书格式化成文件
wget https://pkg.cfssl.org/R1.2/cfssljson_linux-amd64 -O /usr/bin/cfssl-json
# cfss-certinfo  查看证书的信息，发证机构，证书有效期
wget https://pkg.cfssl.org/R1.2/cfssl-certinfo_linux-amd64 -O /usr/bin/cfssl-certinfo
```

```bash
cfssl-certinfo -cert file
cfssl-certinfo -domain domain_name
cfssl-certinfo -domain pinduoduo.com
cfssl certinfo -domain jd.com
cfssl-certinfo -cert apiserver.pem 
cfssl-certinfo -domain dashboard.od.com
```

<span id=openssl>**openssl**</span>

**SSL：** Secure Socket Layer（安全套接层协议)

**TLS：** Transport Layer Security（传输层安全协议）

加密算法

1. RSA算法是一个广泛使用的公钥算法。其密钥包括公钥和私钥。它能用于数字签名、身份认证以及密钥交换。RSA密钥长度一般使用1024位或者更高。
2. DSA (Digital Signature Algorithm)算法是一种公钥算法.

功能

1. 证书签发
2. 文件加密
3. 数字签名
4. 生成随机数

**证书签发**

```bash
#自签CA
openssl genrsa -out caKey.pem 2048
openssl req -new -key caKey.pem -out ca.csr -subj "/C=CN/ST=Gd/L=SZ/O=od.com/CN=harbor.od.com"
openssl x509 -req -in ca.csr -out ca-cert.pem -signkey caKey.pem -days 3650

#签署应用key和crt
# 1)用户生成自己的私钥；
# genrsa Generation of DSA Private Key
# gendsa Generation of DSA Private Key
openssl genrsa -out serverkey.pem 2048
# 2)构造证书申请文件
openssl req  -new -key serverkey.pem -out server.csr -subj "/C=CN/ST=Gd/L=SZ/O=od.com/CN=harbor.od.com"
# req X.509 Certificate Signing Request (CSR) Management.
# -new   new request.
# 3)用户将证书申请文件提交给CA；CA验证签名，提取用户信息，并加上其他信息（比如颁发者等信息）
openssl x509 -req \
-in server.csr \
-out server-cert.pem \
-signkey serverkey.pem \
-CA ca-cert.pem \
-CAkey caKey.pem \
-CAcreateserial \
-days 3650
# x509      X.509 Certificate Data Management.
# -signkey arg    - self sign cert with arg
# -CAcreateserial - create serial number file if it does not exist
# -CA arg         - set the CA certificate, must be PEM format.
# -CAkey arg      - set the CA key, must be PEM format
#                  missing, it is assumed to be in the CA file.
```

另一种签发方式

```bash
# 跳过ca自签秘钥,如Nginx 中ssl
openssl genrsa -out server.key 2048
#-x509   output a x509 structure instead of a cert
openssl req -new -x509 -key server.key -out server.crt -subj /C=CN/ST=GD/L=SZ/O=devops/CN=wangendao.xyz -days 3650
```



`-subj`

```bash
C：Country ，单位所在国家，为两位数的国家缩写，如： CN 就是中国
ST：State/Province ，单位所在州或省
L：Locality ，单位所在城市 / 或县区
O：Organization ，网站的单位名称
OU：Organization Unit，部门名称，也常常用于显示其他证书相关信息，如证书类型，证书产品名称或身份验证类型或验证内容等
CN：Common Name ，网站的域名;
EA：Email Address ，邮箱地址
```







```bash
# 查看证书的信息
# -noout          - no certificate output
# -text           - print the certificate in text form

openssl x509 -noout -text -in server.crt
# 检查证书CN是否与域名匹配
# -checkhost host - check certificate matches "host"
openssl x509 -noout -checkhost seafile.example.com -in cert.pem  
Hostname seafile.example.com does match certificate

#  检查证书是否包含对应ip
# -checkip ipaddr - check certificate matches "ipaddr"
[root@hdss7-21 certs]# openssl x509 -checkip 10.4.7.55 -in kubelet.pem 
IP 10.4.7.55 does NOT match certificate
#  检查证书是否过期
#  -checkend arg   - check whether the cert expires in the next arg seconds
#                  exit 1 if so, 0 if not
[root@hdss7-21 ssl]# openssl x509 -checkend 2592000 -in cert.pem          
Certificate will expire
```





**文件加密**

```bash
# 生成私钥
openssl genrsa -out private.pem 2048
# 生成公钥
openssl rsa -in private.pem -pubout -out public.pem
# 创建文件
echo 12345678 >a.txt
# 加密文件
openssl rsautl -encrypt -in a.txt -inkey public.pem -pubin -out miwen.txt
# 解密文件
openssl rsautl -decrypt -in miwen.txt -inkey private.pem -out b.txt
```

文件摘要（文件md5等验证是否被篡改）

```
openssl dgst -sign private.pem -md5 -out check a.txt
```





**生成随机数**

```
openssl rand -base64 10
openssl rand -hex 10
```

https://www.cnblogs.com/technology178/p/14094375.html
https://blog.csdn.net/qq_35014708/article/details/89351248
https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices
https://www.cnblogs.com/littleatp/p/5878763.html

<span id=dmidecode>查看主机型号：</span>

```bash
[root@spa00x1 ~]# dmidecode |grep 'Product Name'
        
Product Name: PowerEdge R720
Product Name: 0X6FFV
```

查看主机序列号: `dmidecode |grep 'Serial Number'`

查看操作系统：`cat /etc/redhat-release`

查看cpu：`/proc/cpuinfo  `

查看内存：`/proc/meminfo` `free -m`

查看负载: `/proc/loadavg` `load` `uptime`

<span id=nc>nc</span>
[网络命令nc](https://www.jianshu.com/p/fa4eeac44e5c)

<span id=folder>**centos中的目录**</span>

| /etc/rsyslog            | 日志配置文件       |
| ----------------------- | ------------------ |
| /var/spool/clientmqueue | 邮件队列           |
| /etc/motd               | 添加登录时提示信息 |






### 打印ip的方法

```bash
ifconfig eth0|awk -F "[ :]+" 'NR==2{print $4}' 
ifconfig eth0|awk -v FS="[ :]+" 'NR==2{print $4}'
ifconfig eth0|sed -n 's/^.*addr:\(.*\)  Bcast.*$/\1/gp'
```

### awk int()

```bash
[root@seagullcore01-uat-s2 ~]# echo "1 0.1 2%"|awk '{print int($2)}'  
0
```



### 计算字符串长度

```bash
计算字符串长度的三种方法
char=$(seq -s "\t" 100)

echo ${#char}
echo ${char}|wc -m
echo $(expr length $char)  
```

### bash 魔法

```bash
#打印连续序列
echo {0..10}
#打印偶数数列
echo {0..10..2}
#打印组合数列
echo {a..z}{a..z}
echo {0..10}{0..10..2}
#利用序列定义数组
letter_combos=({a..z}{a..z})
echo ${letter_combos[*]} 
```

时间同步
1. 配置chrony
2. 配置时区
ln -sf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone
3. 手动时间同步