<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Log on 零露云</title>
    <link>https://zero-dew.netlify.app/tags/log/</link>
    <description>Recent content in Log on 零露云</description>
    <generator>Hugo</generator>
    <language>zh-cn</language>
    <copyright>零露云©2025版权所有</copyright>
    <lastBuildDate>Wed, 17 Sep 2025 16:12:16 +0800</lastBuildDate>
    <atom:link href="https://zero-dew.netlify.app/tags/log/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>rsyslog</title>
      <link>https://zero-dew.netlify.app/linux/rsyslog.html</link>
      <pubDate>Wed, 17 Sep 2025 16:12:16 +0800</pubDate>
      <guid>https://zero-dew.netlify.app/linux/rsyslog.html</guid>
      <description>&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;yum install rsyslog &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;root@zabbix ~&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# grep -Ev &amp;#39;^$|^#&amp;#39; /etc/rsyslog.conf &lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#开启udp/tcp 514 接收日志&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ModLoad imudp&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$UDPServerRun &lt;span style=&#34;color:#ae81ff&#34;&gt;514&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ModLoad imtcp&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$InputTCPServerRun &lt;span style=&#34;color:#ae81ff&#34;&gt;514&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#默认的日志格式模板，无需定义&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#屏蔽本机的日志&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;:fromhost-ip,!isequal,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;127.0.0.1&amp;#34;&lt;/span&gt; ?RSYSLOG_TraditionalFileFormat&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#所有类型.所以级别&#x9;&#x9;&#x9;&#x9;: :ommysql:主机,库名,用户名,密码&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;*.*                          @filebeat:端口&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#检查语法rsyslog.conf &lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;root@Nagios ~&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# rsyslogd -f /etc/rsyslog.conf -N1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;root@Nagios ~&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# /etc/init.d/rsyslog restart&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;客户端配置&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;H3C 配置&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sys&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;info-center loghost 168.204.37.50&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;linux配置&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;*.* &#x9;@168.204.37.50  &lt;span style=&#34;color:#75715e&#34;&gt;# udp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;*.* &#x9;@@168.204.37.50  &lt;span style=&#34;color:#75715e&#34;&gt;## tcp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;rsyslog.conf&lt;/p&gt;&#xA;&lt;p&gt;rsyslog中的数据库支持是通过可加载的插件模块集成的。要使用数据库功能，必须在使用第一个数据库表操作之前在配置文件中启用数据库插件。这是通过放置&lt;/p&gt;&#xA;&lt;p&gt;$ModLoad ommysql&lt;/p&gt;&#xA;&lt;p&gt;接下来，我们需要告诉rsyslogd将数据写入数据库。由于使用默认架构，因此无需为此定义模板。我们可以使用硬编码的代码（rsyslogd处理正确的模板链接）。因此，对于MySQL，我们需要做的就是在/etc/rsyslog.conf中添加一个简单的选择器行：&lt;/p&gt;&#xA;&lt;p&gt;&lt;em&gt;.&lt;/em&gt;    :ommysql:database-server,database-name,database-userid,database-password&lt;/p&gt;&#xA;&lt;p&gt;例如，如果您仅对来自邮件子系统的消息感兴趣，则可以使用以下选择器行：&lt;/p&gt;&#xA;&lt;p&gt;mail.*    :ommysql:127.0.0.1,syslog,syslogwriter,topsecret&lt;/p&gt;&#xA;&lt;p&gt;如果您要转发多个服务器，则可以很快完成。Rsyslog对操作的数量或类型没有限制，因此您可以定义任意多个目标。然而，重要的是要知道，全套指令构成了一个动作。因此，您不能简单地添加（仅）第二条转发规则，而还需要复制规则配置。请注意，对于第二个操作，请使用不同的队列文件名，否则将使系统混乱。&lt;/p&gt;&#xA;&lt;p&gt;转发到两个主机的示例如下所示：&lt;/p&gt;&#xA;&lt;p&gt;$ ModLoad imuxsock ＃本地消息接收&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
