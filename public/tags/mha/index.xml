<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Mha on 零露云</title>
    <link>https://zero-dew.netlify.app/tags/mha/</link>
    <description>Recent content in Mha on 零露云</description>
    <generator>Hugo</generator>
    <language>zh-cn</language>
    <copyright>零露云©2025版权所有</copyright>
    <lastBuildDate>Mon, 28 Jul 2025 10:57:00 +0800</lastBuildDate>
    <atom:link href="https://zero-dew.netlify.app/tags/mha/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>mha</title>
      <link>https://zero-dew.netlify.app/mysql/mha.html</link>
      <pubDate>Mon, 28 Jul 2025 10:57:00 +0800</pubDate>
      <guid>https://zero-dew.netlify.app/mysql/mha.html</guid>
      <description>&lt;table&gt;&#xA;  &lt;thead&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;th&gt;主机名&lt;/th&gt;&#xA;          &lt;th&gt;IP&lt;/th&gt;&#xA;          &lt;th&gt;server_id&lt;/th&gt;&#xA;          &lt;th&gt;角色&lt;/th&gt;&#xA;          &lt;th&gt;版本&lt;/th&gt;&#xA;          &lt;th&gt;设置&lt;/th&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/thead&gt;&#xA;  &lt;tbody&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;mysqldbphw01&lt;/td&gt;&#xA;          &lt;td&gt;172.32.4.10/24&lt;/td&gt;&#xA;          &lt;td&gt;1&lt;/td&gt;&#xA;          &lt;td&gt;&lt;code&gt;master&lt;/code&gt;/&lt;code&gt;MHA Node&lt;/code&gt;&lt;/td&gt;&#xA;          &lt;td&gt;5.6.40&lt;/td&gt;&#xA;          &lt;td&gt;1.设置server-id&lt;br&gt;2.开启binlog&lt;br&gt;3.配置vip 172.32.4.50/24&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;mysqldbphw02&lt;/td&gt;&#xA;          &lt;td&gt;172.32.4.20/24&lt;/td&gt;&#xA;          &lt;td&gt;2&lt;/td&gt;&#xA;          &lt;td&gt;&lt;code&gt;slave&lt;/code&gt;/&lt;code&gt;MHA Node&lt;/code&gt;&lt;/td&gt;&#xA;          &lt;td&gt;5.6.40&lt;/td&gt;&#xA;          &lt;td&gt;1.设置server-id&lt;br&gt;2.设置为只读&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;mysqldbphw03&lt;/td&gt;&#xA;          &lt;td&gt;172.32.4.30/24&lt;/td&gt;&#xA;          &lt;td&gt;3&lt;/td&gt;&#xA;          &lt;td&gt;&lt;code&gt;slave&lt;/code&gt;/&lt;code&gt;MHA Node&lt;/code&gt;&lt;/td&gt;&#xA;          &lt;td&gt;5.6.40&lt;/td&gt;&#xA;          &lt;td&gt;1.设置server-id&lt;br/&gt;2.设置为只读&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;mysqldbphw04&lt;/td&gt;&#xA;          &lt;td&gt;172.32.4.40/24&lt;/td&gt;&#xA;          &lt;td&gt;&lt;/td&gt;&#xA;          &lt;td&gt;&lt;code&gt;MHA Manager&lt;/code&gt;&lt;/td&gt;&#xA;          &lt;td&gt;&lt;/td&gt;&#xA;          &lt;td&gt;&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;&#xA;&#xA;&lt;div class=&#34;alert alert-primary&#34; role=&#34;alert&#34;&gt;&#xA;&#xA;&#xA;    &lt;ul&gt;&#xA;&lt;li&gt;添加一个vip 用于应用接入&lt;/li&gt;&#xA;&lt;li&gt;设置ssh免密要认证，用于failover时执行网络、binlog拷贝等动作&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&#xA;&lt;/div&gt;&#xA;&lt;/td&gt;&#xA;          &lt;td&gt;&lt;/td&gt;&#xA;          &lt;td&gt;&lt;/td&gt;&#xA;          &lt;td&gt;&lt;/td&gt;&#xA;          &lt;td&gt;&lt;/td&gt;&#xA;          &lt;td&gt;&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/tbody&gt;&#xA;&lt;/table&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ifconfig eth0:2 172.32.4.50/24&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ssh-keygen -t rsa -f /root/.ssh/id_rsa -N &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2.5测试&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;主库手工绑定vip：ifconfig eth0:1 168.204.37.17/24 up &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;masterha_check_ssh --conf&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;/etc/mha/app1.cnf &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;masterha_check_repl --conf&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;/etc/mha/app1.cnf&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2.6启动&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;root@mysqldbphw04 /&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# nohup masterha_manager --conf=/etc/mha/app1.cnf &amp;gt; /mha/manager.log &amp;lt; /dev/null &amp;amp;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;1&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;933&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;查看运行状态&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;root@mysqldbphw04 /&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# masterha_check_status --conf=/etc/mha/app1.cnf&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;app1 &lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;pid:933&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt; is running&lt;span style=&#34;color:#f92672&#34;&gt;(&lt;/span&gt;0:PING_OK&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;, master:mysqldbphw01&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;2.7关闭&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;masterha_sotp  --conf&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;/etc/mha/app1.cnf&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;root@mysqldbphw04 /&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# masterha_secondary_check -s mysqldbphw01 -s  mysqldbp&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hw02  -s mysqldbphw03 --user&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;root --master_host&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;mysqldbphw01 --master_ip&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;172&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.32.4.10 --master_port&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3306&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Master is reachable from mysqldbphw01!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://www.cnblogs.com/xiaoyuxixi/p/13814811.html&#34; target=&#34;_blank&#34;&gt;MYSQL高可用架构MGR、MHA对比 - 小雨淅淅o0 - 博客园 (cnblogs.com)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
